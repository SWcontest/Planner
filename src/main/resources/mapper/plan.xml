<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="WeekRoute.planer.mapper.PlanMapper">
    <resultMap id="Plan" type="WeekRoute.planer.domain.Plan">
        <result property="id" column="id" />
        <result property="login_id" column="login_id" />
        <result property="day" column="day" />
        <result property="title" column="title" />
        <result property="contents" column="contents" />
        <result property="place" column="place" />
        <result property="start_time" column="start_time" />
        <result property="end_time" column="end_time" />
        <result property="total_time" column="total_time" />
        <result property="activate" column="activate" />
    </resultMap>

    <select id="getCurrentId" parameterType="int">
        select
            max(id) + 1 as id
        from plan
    </select>

    <select id="getPlanList" resultMap="Plan">
        SELECT
            *
        FROM
            plan
        <where>
            <if test=" loginId != null and loginId != '' ">
                AND login_id = #{loginId}
            </if>
            <if test=" day != null and !day.equals('') ">
                AND day = #{day}
            </if>
            <if test=" time == 1 ">
                AND time is not null
            </if>
            <if test=" time == 0 ">
                AND time is null
            </if>
            <if test=" place != null and place != '' ">
                AND place = #{place}
            </if>
        </where>

    </select>

    <insert id="addPlan" parameterType="map" keyProperty="param.id">
        INSERT INTO plan
        (
            id, login_id, day, title, contents, place, start_time, end_time, total_time, activate
        )
        VALUES
            (
                #{param.id}, #{param.login_id}, #{param.day}, #{param.title}, #{param.contents}, #{param.place}, #{param.start_time}, #{param.end_time}, #{param.total_time}, #{param.activate}
            )
    </insert>
</mapper>